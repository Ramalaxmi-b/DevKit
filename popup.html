<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>DevKit</title>
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <style>
    body {
      width: 350px; 
    }
  </style>
</head>
<body>
  <div class="container">
    <ul class="nav nav-tabs" id="myTab" role="tablist">
      <li class="nav-item">
        <a class="nav-link active" id="window-resizer-tab" data-toggle="tab" href="#window-resizer" role="tab" aria-controls="window-resizer" aria-selected="true">Window Resizer</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="link-checker-tab" data-toggle="tab" href="#link-checker" role="tab" aria-controls="link-checker" aria-selected="false">Link Checker</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="tech-analyzer-tab" data-toggle="tab" href="#tech-analyzer" role="tab" aria-controls="tech-analyzer" aria-selected="false">Tech Analyzer</a>
      </li>
    </ul>
    <div class="tab-content" id="myTabContent">
      <div class="tab-pane fade show active" id="window-resizer" role="tabpanel" aria-labelledby="window-resizer-tab">
        <div class="mt-3">
          <h2>Window Resizer</h2>
          <div class="form-group">
            <label for="predefined-sizes">Predefined Sizes:</label>
            <select id="predefined-sizes" class="form-control">
              <option value="1024x768">1024x768</option>
              <option value="1366x768">1366x768</option>
              <option value="1920x1080">1920x1080</option>
            </select>
          </div>
          <div class="form-group">
            <label for="custom-width">Width (px):</label>
            <input type="number" id="custom-width" class="form-control">
          </div>
          <div class="form-group">
            <label for="custom-height">Height (px):</label>
            <input type="number" id="custom-height" class="form-control">
          </div>
          <button id="apply-size" class="btn btn-primary btn-block">Apply</button>
          <button id="reset-size" class="btn btn-secondary btn-block">Reset to Default</button>
          <div class="mt-3 text-center">
            <span class="tooltip">
              <i class="fas fa-info-circle"></i>
              <span class="tooltiptext">Resize the browser window to predefined or custom dimensions.</span>
            </span>
          </div>
        </div>
      </div>
      <div class="tab-pane fade" id="link-checker" role="tabpanel" aria-labelledby="link-checker-tab">
        <div class="mt-3">
          <h2>Link Checker</h2>
          <div class="form-group">
            <label for="page-url">Page URL:</label>
            <input type="text" id="page-url" class="form-control">
          </div>
          <button id="check-links" class="btn btn-primary btn-block">Check Links</button>
          <div id="link-results" class="mt-3"></div>
          <div class="mt-3 text-center">
            <span class="tooltip">
              <i class="fas fa-info-circle"></i>
              <span class="tooltiptext">Check for broken links on the specified page.</span>
            </span>
          </div>
        </div>
      </div>
      <div class="tab-pane fade" id="tech-analyzer" role="tabpanel" aria-labelledby="tech-analyzer-tab">
        <div class="mt-3">
          <h2>Tech Analyzer</h2>
          <div class="form-group">
            <label for="tech-url">Page URL:</label>
            <input type="text" id="tech-url" class="form-control">
          </div>
          <button id="analyze-tech" class="btn btn-primary btn-block">Analyze Tech</button>
          <div id="tech-results" class="mt-3"></div>
          <div class="mt-3 text-center">
            <span class="tooltip">
              <i class="fas fa-info-circle"></i>
              <span class="tooltiptext">Analyze the technologies used on the specified page.</span>
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.10.2/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      document.getElementById('apply-size').addEventListener('click', applySize);
      document.getElementById('reset-size').addEventListener('click', resetSize);
      document.getElementById('check-links').addEventListener('click', checkLinks);
      document.getElementById('analyze-tech').addEventListener('click', analyzeTech);
    });

    function applySize() {
      const predefinedSize = document.getElementById('predefined-sizes').value.split('x');
      const customWidth = document.getElementById('custom-width').value;
      const customHeight = document.getElementById('custom-height').value;
      let width = parseInt(predefinedSize[0], 10);
      let height = parseInt(predefinedSize[1], 10);

      if (customWidth) width = parseInt(customWidth, 10);
      if (customHeight) height = parseInt(customHeight, 10);

      chrome.windows.getCurrent(function (win) {
        chrome.windows.update(win.id, { width, height });
      });
    }

    function resetSize() {
      chrome.windows.getCurrent(function (win) {
        chrome.windows.update(win.id, { width: 800, height: 600 });
      });
    }

    function checkLinks() {
      const url = document.getElementById('page-url').value;
      fetch(url)
        .then(response => response.text())
        .then(html => {
          const parser = new DOMParser();
          const doc = parser.parseFromString(html, 'text/html');
          const links = doc.querySelectorAll('a');
          const results = [];
          links.forEach(link => {
            fetch(link.href)
              .then(response => {
                if (!response.ok) {
                  results.push(`${link.href} is broken.`);
                }
              })
              .catch(() => {
                results.push(`${link.href} is broken.`);
              });
          });
          setTimeout(() => {
            document.getElementById('link-results').innerText = results.join('\n');
          }, 3000); 
        });
    }

    function analyzeTech() {
      const url = document.getElementById('tech-url').value;
      fetch(`https://api.wappalyzer.com/lookup/?urls=${encodeURIComponent(url)}`)
        .then(response => response.json())
        .then(data => {
          const technologies = data.technologies;
          const results = technologies.map(tech => tech.name).join(', ');
          document.getElementById('tech-results').innerText = results;
        });
    }
  </script>
</body>
</html>
